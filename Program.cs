using System;
using System.Collections.Generic;
using System.Linq;

namespace Routing.AI
{
    public class Program
    {
        static void Main(string[] args)
        {
            // Desired number of clusters.
            const int NO_OF_CLUSTERS = 3;
            // Maximum weight per cluster.
            const int MAX_WEIGHT = 2000;
            // Noise penalty is 50km for each noise.
            const long NOISE_PENALTY = 50000;

            Console.WriteLine("Instantiate problem: Nodes={0}, clusters={1}, max weight={2}", DataModel.NodesCount, NO_OF_CLUSTERS, MAX_WEIGHT);

            // Build the clusters list
            List<Cluster> clusters = new List<Cluster>();
            // Build the noises list
            List<Node> noises = new List<Node>();

            // First cluster
            Cluster cluster = new Cluster(clusters.Count + 1, MAX_WEIGHT);
            // Dummy solution: add nodes in order until reach the max weight of the cluster.
            // The remaining nodes, if any, are kept in noises list. Noises list have a penalty.
            for (int i = 0; i < DataModel.NodesCount; i++)
            {
                if (cluster.AddNode(i, DataModel.Weights[i]))
                {
                    // Node added in cluster
                }
                else
                {
                    if (clusters.Count < NO_OF_CLUSTERS)
                    {
                        // Add the cluster's clone to the list
                        clusters.Add(cluster.Clone());
                        // Instantiate a new empty cluster
                        cluster = new Cluster(clusters.Count + 1, MAX_WEIGHT);
                        // Add the node to the new cluster
                        cluster.AddNode(i, DataModel.Weights[i]);
                    }
                    else
                    {
                        //no more clusters
                        cluster = null;
                        // Add to noises
                        noises.Add(new Node(i, DataModel.Weights[i]));
                    }
                }
            }
            // Add the last cluster
            if (cluster != null)
                clusters.Add(cluster);

            // Print the Solution
            long solutionTotal = PrintSolution(clusters, noises, NOISE_PENALTY);
            Console.WriteLine("Solution Total {0}", solutionTotal);
        }

        private static long PrintSolution(List<Cluster> clusters, List<Node> noises, long penalty)
        {
            long overallDistances = 0;
            Console.WriteLine("Solution: clusters={0}, noises={1}:", clusters.Count, noises.Count);
            Console.WriteLine();
            foreach (Cluster cluster in clusters)
            {
                Console.WriteLine("Cluster id={0} nodes {1}:", cluster.Id, cluster.Nodes.Count);
                for (int i = 0; i < cluster.Nodes.Count; i++)
                {
                    Node current_node = cluster.Nodes[i];
                    Console.Write(current_node.Index + (i < cluster.Nodes.Count - 1 ? ", " : ""));
                }
                Console.WriteLine();
                int totalWeight = cluster.TotalWeight;
                long totalDistance = cluster.TotalDistance;
                Console.WriteLine("Cluster totals: Weight = {1} kg / Distance = {0} m", cluster.TotalDistance, cluster.TotalWeight);
                Console.WriteLine();
                overallDistances += totalDistance;
            }
            long noisesDistances = (penalty * penalty) * noises.Count;
            Console.WriteLine("Overall distances: clusters {0} m / noises {1} m", overallDistances, noisesDistances);
            Console.WriteLine();

            return overallDistances + noisesDistances;
        }

        class Cluster
        {
            public int Id { get; set; }
            public int MaxWeight { get; set; }

            public List<Node> Nodes { get; set; }

            public int TotalWeight
            {
                get
                {
                    return this.Nodes.Sum(p => p.Weight);
                }
            }

            public long TotalDistance
            {
                get
                {
                    long dist = 0;
                    for (int i = 0; i < this.Nodes.Count; i++)
                        for (int j = 0; j < this.Nodes.Count; j++)
                            if (i != j)
                                dist += DataModel.DistanceMatrix[this.Nodes[i].Index, this.Nodes[j].Index];
                    return dist;
                }
            }

            public Cluster(int id, int maxWeight)
            {
                this.Id = id;
                this.MaxWeight = maxWeight;
                this.Nodes = new List<Node>();
            }

            public bool AddNode(int index, int weight)
            {
                if (this.TotalWeight + weight > this.MaxWeight)
                    return false;
                else
                    this.Nodes.Add(new Node(index, weight));
                return true;
            }

            public Cluster Clone()
            {
                Cluster clone = new Cluster(this.Id, this.MaxWeight);
                foreach (Node node in this.Nodes)
                    clone.Nodes.Add(node.Clone());
                return clone;
            }
        }

        class Node
        {
            public int Index { get; set; }
            public int Weight { get; set; }

            public Node(int index, int weight)
            {
                this.Index = index;
                this.Weight = weight;
            }

            public Node Clone()
            {
                return new Node(this.Index, this.Weight);
            }
        }

        static class DataModel
        {
            public static int NodesCount
            {
                get { return Weights.Length; }
            }

            public static int[] Weights = { 76, 95, 57, 0, 57, 38, 76, 190, 33, 66, 33, 33, 57, 57, 57, 0, 76, 66, 190, 57, 57, 76, 285, 114, 133, 152, 38, 171, 76, 44, 57, 0, 44, 76, 0, 190, 33, 33, 76, 95, 76, 0, 76, 0, 0, 38, 285, 44, 95, 285, 76, 33, 44, 44, 57, 38, 55, 38, 57, 57, 57, 57, 55, 57, 57, 33, 0, 22, 38, 38 };
            public static long[,] DistanceMatrix = {
{0,12507,14912,14912,22005,27078,21570,37100,30206,31270,31709,32312,26220,23628,23979,23979,27337,33879,35990,32918,37894,45211,45895,45874,45610,46706,46712,45148,45031,43918,38242,37908,39070,38410,38410,38266,38188,38217,38071,37931,38267,38190,33861,47712,47712,40072,43155,42356,50097,44410,44450,50535,45148,49432,51406,51285,50691,48744,46709,46955,47536,46848,49908,51388,51198,51244,51198,50940,50530,51075},
{12550,0,9004,9004,18479,17432,11924,27454,34480,33429,34763,34246,21628,19036,19386,19386,22745,29287,39177,36104,41081,35565,36249,36228,35964,37060,37065,35502,35385,34272,35027,34693,36682,35760,35760,35968,36191,36220,37635,41117,38627,38550,37883,38066,38066,37774,40857,40852,40450,43465,42737,43933,43232,52618,41760,41639,41045,39098,37063,37309,37889,37202,40262,41742,41552,41597,41552,41293,40884,41429},
{14858,9027,0,0,8409,10713,17294,18817,16610,17673,18113,18715,12624,10032,10382,10382,13740,20283,22394,19321,24298,28042,27568,27444,27122,26806,26706,26068,26167,25676,24645,24311,25474,24814,24814,24670,24591,24621,24475,24334,24671,24594,20265,27812,27812,26476,29559,28760,29459,30814,30853,36939,31552,35835,35814,34940,35078,32383,29550,29740,30790,29742,32693,33994,33688,33862,33688,34004,34185,34730},
{14858,9027,0,0,8409,10713,17294,18817,16610,17673,18113,18715,12624,10032,10382,10382,13740,20283,22394,19321,24298,28042,27568,27444,27122,26806,26706,26068,26167,25676,24645,24311,25474,24814,24814,24670,24591,24621,24475,24334,24671,24594,20265,27812,27812,26476,29559,28760,29459,30814,30853,36939,31552,35835,35814,34940,35078,32383,29550,29740,30790,29742,32693,33994,33688,33862,33688,34004,34185,34730},
{21999,19431,8373,8373,0,2873,7803,10977,13297,14360,14800,15402,9311,6718,7069,7069,11280,16970,19081,16008,20985,24728,24255,24130,23808,23492,23393,22754,22854,22362,21332,20998,22161,21500,21500,21357,21278,21308,21161,21021,21358,21281,16952,24499,24499,23162,26246,25446,26145,27501,27540,33626,28238,32522,38278,38158,37564,35617,26236,26427,27477,26429,29380,30680,30374,30548,30374,30690,37402,37948},
{24204,18285,10577,10577,2774,0,6657,8533,14712,14023,14040,14407,10726,8134,8484,8484,12695,18385,21847,18774,23752,21265,21948,31600,21664,24907,24808,21202,20564,19557,22747,22413,23576,22916,22916,22772,22693,22723,22577,23788,22773,22696,18367,25914,25914,24578,27661,26862,27560,28916,36106,36392,29654,35289,37132,37011,36417,34470,32435,32681,33262,32574,35634,37114,36924,36970,36924,36665,36256,36801},
{22507,12823,15553,15553,7749,6702,0,17364,24390,23339,24673,24156,15701,13109,13460,13460,17670,23360,29087,26014,30991,25475,26159,26138,25874,26970,26975,25412,25295,24182,24937,24603,26592,25670,25670,25878,26101,26131,27545,31027,28537,28460,27793,27976,27976,27684,30767,30762,30361,33375,32647,33843,33142,42528,31670,31549,30955,29008,26973,27219,27799,27112,30172,31652,31462,31507,31462,31203,30794,31339},
{38090,28406,22209,22209,10977,8533,18800,0,8617,7566,8900,8383,10941,15711,16061,16061,18813,18530,13314,10241,15218,12732,13415,13671,13130,13651,13552,12669,12030,11023,11443,11109,12772,12112,12112,16425,16347,16376,16230,15254,16924,16666,8536,14658,14658,18231,21314,20515,16757,28331,27573,27859,19538,26755,28606,19494,27891,16952,14917,15188,15744,15056,18140,19596,19407,19452,19407,19148,18738,19284},
{31968,36738,18342,18342,15049,16564,27132,10049,0,4593,5032,5635,7073,11843,12194,12194,11711,12525,7309,4236,9213,14961,14488,14363,14041,13725,13626,12987,13087,12595,11565,11231,12394,11733,11733,11590,11511,11541,11394,9249,10919,10661,7184,14732,14732,13395,16479,15679,16378,22326,21568,21854,23714,20750,22734,21860,21997,19303,16469,16660,17710,16662,19612,20913,20607,20781,20607,20923,21104,21650},
{28081,23482,14455,14455,11162,12677,24816,7732,5580,0,950,1317,3187,7957,8307,8307,12518,15493,10277,7204,12182,15616,15142,15018,14696,14380,14280,13642,13741,13250,12220,11885,13048,12388,12388,12244,12165,12195,12049,12218,13888,13629,7839,15386,15386,14050,17133,16334,17033,25294,24536,24822,19126,23719,23388,22514,22652,19957,17124,17314,18364,17316,20267,21568,21262,21436,21262,21578,21759,22304},
{27677,23077,14050,14050,10758,12273,17203,8044,5892,845,0,780,2782,7552,7903,7903,12114,15805,10590,7517,12494,16016,15542,15418,15096,14780,14680,14042,14142,13650,12620,12286,13448,12788,12788,12644,12565,12595,12449,12530,14200,13942,8239,15786,15786,14450,17533,16734,17433,25606,24849,25134,19526,24031,23788,22914,23052,20358,17524,17715,18764,17716,20667,21968,21662,21836,21662,21978,22159,22704},
{27231,22632,13605,13605,10313,11827,16757,8086,5934,1556,711,0,2337,7107,7458,7458,11669,15847,10631,7558,12535,18798,18325,18200,17878,17562,17463,16824,16924,16432,15402,15068,16231,15570,15570,15427,15348,15378,15231,12571,15428,13983,11021,18569,18569,17232,20316,19516,20215,25648,24890,25176,22308,24072,26571,25697,25834,23140,20306,20497,21547,20499,23449,24750,24444,24618,24444,24760,24941,25487},
{26197,21598,12571,12571,9278,10793,15723,12869,6350,7413,7853,8455,0,6073,6424,6424,10229,15757,12134,9061,14038,17782,17308,17184,16862,16546,16446,15808,15907,15416,14386,14051,15214,14554,14554,14410,14331,14361,14215,14074,14411,14334,10005,17552,17552,16216,19299,18500,19199,20554,20593,26679,21292,25576,25554,24680,24818,22123,19290,19480,20530,19482,22433,23734,23428,23602,23428,23744,23925,24470},
{23653,19054,10027,10027,6735,8249,13179,16579,10060,11123,11563,12165,6074,0,1557,1557,5768,11458,15844,12771,17748,21492,21018,20894,20572,20256,20156,19518,19617,19126,18095,17761,18924,18264,18264,18120,18041,18071,17925,17784,18121,18044,13715,21262,21262,19926,23009,22210,22908,24264,24303,30389,25002,29285,29264,28390,28528,25833,23000,23190,24240,23192,26143,27444,27138,27312,27138,27454,27635,28180},
{24004,19405,10378,10378,7085,8600,13530,16930,10411,11474,11914,12516,6425,1557,0,0,4992,10682,16195,13122,18099,21842,21369,21244,20922,20606,20507,19868,19968,19476,18446,18112,19275,18614,18614,18471,18392,18422,18275,18135,18472,18395,14066,21613,21613,20276,23360,22560,23259,24615,24654,30740,25352,29636,29615,28741,28878,26184,23350,23541,24591,23543,26494,27794,27488,27662,27488,27804,27985,28531},
{24004,19405,10378,10378,7085,8600,13530,16930,10411,11474,11914,12516,6425,1557,0,0,4992,10682,16195,13122,18099,21842,21369,21244,20922,20606,20507,19868,19968,19476,18446,18112,19275,18614,18614,18471,18392,18422,18275,18135,18472,18395,14066,21613,21613,20276,23360,22560,23259,24615,24654,30740,25352,29636,29615,28741,28878,26184,23350,23541,24591,23543,26494,27794,27488,27662,27488,27804,27985,28531},
{28215,23616,14589,14589,11296,12811,17741,19041,11717,13585,14024,14627,10636,5768,4992,4992,0,10690,14561,15233,20210,23953,23480,23355,23033,22717,22618,21979,22079,21587,20557,20223,21386,20725,20725,20582,20503,20533,20386,20246,20583,20506,16176,23724,23724,22387,25471,24671,25370,26726,26765,32850,27463,31747,31726,30852,30990,28295,25461,25652,26702,25654,28604,29906,29599,29773,29599,29915,30096,30642},
{33924,29325,20298,20298,17006,18520,23450,18672,16627,14666,15105,15708,16345,11477,10701,10701,10709,0,5444,9818,11013,19213,18739,18615,18292,17094,16810,17476,17897,18260,16375,16041,16329,15748,15748,15352,14678,14707,13610,11049,12719,12461,16480,17823,17823,15908,18992,18192,19167,24125,23368,23653,25513,22550,26985,26111,26249,23554,20721,20912,21961,20913,23877,25178,24872,25046,24872,25188,25330,25901},
{36825,40146,23199,23199,19906,21990,30541,13457,11411,9450,9889,10492,11930,16700,14554,14554,14563,5446,0,4602,5797,13997,13524,13399,13077,11878,11594,12261,12681,13044,11159,10825,11113,10532,10532,10137,9462,9491,8395,5833,7503,7245,11264,12607,12607,10693,13776,12977,13952,18910,18152,18438,20298,17334,21770,20895,21033,18339,15505,15696,16746,15697,18662,19963,19656,19831,19656,19973,20115,20685},
{36291,39612,22665,22665,19372,21456,30007,12923,10878,8916,9356,9958,11396,16166,16517,16517,17692,8575,3359,0,5263,13463,12990,12865,12543,11345,11060,11727,12147,12510,10626,10291,10579,9998,9998,9603,8928,8958,7861,5300,6970,6711,10730,12074,12074,10159,13243,12443,13418,18376,17618,17904,19764,16801,21236,20362,20499,17805,14971,15162,16212,15164,18128,19429,19123,19297,19123,19439,19581,20152},
{38889,42210,25263,25263,21970,24054,32605,15521,13476,11514,11954,12556,13994,18764,19115,19115,20441,11324,6108,6666,0,9096,8622,8498,8176,6977,6693,7359,7780,8143,6258,5924,6212,5631,5631,5235,4561,4590,3494,1065,2774,2516,8294,7706,7706,5792,8875,8076,9050,10130,10169,11365,10868,16310,16868,15994,16132,13438,10604,10795,11844,10796,13761,15062,14755,14930,14755,15072,15213,15784},
{45677,35992,28087,28087,24794,21094,26386,12561,17008,14338,14778,15380,16818,21589,21939,21939,26150,19321,14106,14663,9299,0,908,1164,1667,3351,3570,2852,2735,3214,4222,4324,3676,3701,3701,4620,4843,4873,6681,8580,7776,8142,9987,3691,3691,6159,9221,7036,6075,9090,8362,9558,9067,11680,8174,7300,7438,4743,2490,2681,3731,2683,5633,6934,6628,6802,6628,6944,6545,7090},
{46325,36641,28051,28051,24758,21743,27035,13209,16972,14302,14742,15344,16782,21552,21903,21903,26114,18833,13617,14175,8810,1143,0,266,1179,2375,2593,2364,2247,3477,3734,3942,3188,3213,3213,4132,4355,4384,6193,8091,7288,7654,9951,3256,3256,5671,8733,6601,5640,8655,7927,9123,8632,11245,8320,7446,7584,4889,2055,2246,3296,2248,5198,6500,6193,6367,6193,6509,6690,7236},
{46571,36886,28094,28094,24802,21988,27281,13455,17015,14346,14785,15388,16826,21596,21947,21947,26158,18876,13661,14219,8854,1274,268,0,1223,2108,2327,2408,2291,3608,3778,3986,3231,3257,3257,4176,4398,4428,6236,8135,7331,7698,9994,2920,2920,5147,8209,6265,5305,8319,7592,8787,8297,10910,8481,7607,7745,5050,2216,2407,3457,2409,5360,6661,6354,6528,6354,6670,6851,7397},
{46766,37081,27924,27924,24632,22183,27476,13650,16845,14176,14615,15218,16656,21426,21777,21777,25988,18747,13532,14089,8725,1468,904,775,0,1611,1829,2602,2486,3802,3915,4124,3102,3128,3128,4046,4269,4299,6107,8006,7202,7568,9825,2617,2617,4650,7712,5962,5002,8016,7289,8484,7783,11561,9163,8288,8426,5732,2898,3089,4139,3091,6041,7342,7036,7210,7036,7352,7533,8078},
{47586,37902,27135,27135,23842,22342,28296,13809,16056,13386,13826,14428,15866,20637,20987,20987,25198,17108,11893,12450,7086,2736,2172,1939,2276,0,639,2441,2649,3984,3136,3344,2313,2338,2338,3257,3480,3509,4841,6367,5563,5929,9035,1053,1053,3040,6102,4398,3438,6452,5725,6920,6219,10504,9706,8832,8969,6275,3441,3968,5018,3970,6513,7814,7508,7682,7508,7824,8076,8622},
{46948,37263,26506,26506,23214,21703,27658,13170,15427,12758,13197,13800,15238,20008,20359,20359,24570,17329,12114,12671,7307,2600,2035,1906,1637,572,0,1802,2010,3346,2497,2705,1684,1709,1709,2628,2851,2881,4689,6588,5784,6150,8406,1579,1579,3467,6529,4924,3963,6978,6250,7446,6744,10819,10020,9146,9284,6589,3756,4220,5270,4222,6827,8128,7822,7996,7822,8138,8391,8936},
{45763,36078,26109,26109,22816,20805,26473,12272,15030,12361,12800,13403,14841,19611,19962,19962,24172,17186,11970,12528,7163,3231,2757,2633,2311,2023,1924,0,962,2214,1792,2001,1540,1566,1566,2484,2707,2737,4545,6444,5640,6006,8009,3030,3030,4023,7086,5718,5464,8479,7751,8947,8246,12270,11003,10129,10267,7572,4739,4930,5979,4931,7882,9183,8877,9051,8877,9193,9374,9919},
{45929,36244,26008,26008,22716,20396,26639,11862,14929,12260,12699,13302,14740,19510,19860,19860,24072,17558,12342,12900,7536,2904,2660,2915,2284,2396,2297,734,0,1805,2182,2245,1913,1938,1938,2857,3080,3110,4918,6816,6450,6374,7908,3402,3402,4389,7451,6083,5830,8844,8117,9312,8611,12643,10568,9694,9831,7137,4641,4832,5881,4833,7784,9085,8779,8953,8779,9095,8938,9484},
{44605,34920,25242,25242,21950,20132,25314,11599,14163,11494,11933,12536,13974,18744,19095,19095,23306,17062,11847,12405,7040,3009,2765,3021,2389,2958,2859,1340,1007,0,1458,1480,2148,1488,1488,2407,2630,2659,4422,6321,5685,5608,7142,3965,3965,4212,7296,6386,6133,9148,8420,9616,8914,13206,10673,9799,9937,7242,4746,4937,5987,4939,7889,9190,8884,9058,8884,9200,9044,9589},
{37902,35708,24276,24276,20984,22498,26103,15243,13197,10528,10967,11570,13008,17778,18128,18128,22340,16096,10880,11438,6074,4254,4105,3980,3658,3342,3243,2243,2227,2590,0,208,2154,1493,1493,1788,2011,2041,3456,5355,4718,4642,6176,4349,4349,3594,6678,5878,6138,7932,8425,9621,8920,13006,12351,11477,11615,8920,6086,6277,7327,6279,9230,10531,10224,10399,10224,10541,10721,11267},
{37720,35808,24094,24094,20801,22316,26203,15060,13014,10345,10784,11387,12825,17595,17946,17946,22157,15914,10698,11256,5891,4318,3844,3719,3397,3081,2982,2342,2327,2689,805,0,1946,1285,1285,1606,1829,1858,3273,5172,4536,4459,5994,4088,4088,3412,6495,5696,5930,7750,8217,9413,8711,12798,12090,11216,11354,8659,5826,6016,7066,6018,8969,10270,9963,10138,9963,10280,10460,11006},
{38659,36580,25033,25033,21740,23255,26974,15999,13954,11284,11724,12326,13764,18534,18885,18885,23096,15855,10640,11198,5833,3924,3451,3326,3004,2345,2246,1964,2180,2716,1256,1464,0,236,236,1154,1377,1407,3215,5114,4310,4676,6933,3352,3352,2960,6044,5134,4881,7895,7167,8363,7662,11748,11696,10822,10960,8266,5432,5623,6673,5624,8575,9876,9570,9744,9570,9886,10067,10612},
{38423,37096,24797,24797,21504,23019,27490,15764,13718,11048,11488,12090,13529,18299,18649,18649,22860,15620,10404,10962,5597,4019,3546,3421,3099,2584,2485,2282,2499,3034,1241,1758,1135,0,0,919,1142,1171,2979,4878,4074,4441,6697,3591,3591,2724,5808,5373,5120,7063,7406,8602,7901,11988,11792,10917,11055,8361,5527,5718,6768,5719,8670,9971,9665,9839,9665,9981,10162,10707},
{38423,37096,24797,24797,21504,23019,27490,15764,13718,11048,11488,12090,13529,18299,18649,18649,22860,15620,10404,10962,5597,4019,3546,3421,3099,2584,2485,2282,2499,3034,1241,1758,1135,0,0,919,1142,1171,2979,4878,4074,4441,6697,3591,3591,2724,5808,5373,5120,7063,7406,8602,7901,11988,11792,10917,11055,8361,5527,5718,6768,5719,8670,9971,9665,9839,9665,9981,10162,10707},
{38539,37212,24913,24913,21620,23135,27606,15880,13834,11164,11604,12206,13645,18415,18765,18765,22976,15358,10142,10700,5335,4707,4234,4109,3787,3273,3173,2971,3187,3722,2209,1875,1823,1242,1242,0,742,772,2717,4616,3812,4179,6813,4279,4279,2029,5112,4313,5386,6367,6407,7602,7105,11541,12480,11606,11743,9049,6215,6406,7456,6408,9358,10659,10353,10527,10353,10669,10850,11396},
{38367,37040,24741,24741,21448,22963,27434,15707,13662,10992,11432,12034,13473,18243,18593,18593,22804,14944,9728,10286,4921,4535,4062,3937,3615,3100,3001,2799,3015,3550,2037,1702,1651,1070,1070,675,0,30,2304,4202,3398,3765,6641,4107,4107,2480,5564,4764,5637,6819,6858,8054,7556,11993,12308,11434,11571,8877,6043,6234,7284,6236,9186,10487,10181,10355,10181,10497,10678,11224},
{38338,37010,24711,24711,21419,22934,27405,15678,13632,10963,11402,12005,13443,18213,18564,18564,22775,14914,9699,10256,4892,4506,4032,3908,3585,3071,2972,2769,2986,3521,2007,1673,1622,1041,1041,645,436,0,2274,4173,3369,3735,6612,4078,4078,2451,5534,4735,5607,6789,6828,8024,7527,11963,12278,11404,11542,8847,6014,6204,7254,6206,9157,10458,10152,10326,10152,10468,10648,11194},
{38167,38742,24541,24541,21248,22763,29136,15507,13462,10792,11232,11834,13272,18042,18393,18393,22604,13508,8292,8850,3486,6576,6103,5978,5656,5141,4823,4840,5260,5623,3738,3404,3692,3111,3111,2716,2041,2070,0,2766,1963,2329,6441,5836,5836,3922,7006,6206,7181,8260,8300,9496,8998,18815,14348,13474,13612,10918,8084,8275,9325,8276,11227,12528,12222,12396,12222,12538,12719,13264},
{38598,41919,24972,24972,21679,23763,32314,15230,13184,11223,11662,12265,13703,18473,18824,18824,20150,11033,5817,6375,999,8434,7961,7836,7514,6316,6031,6698,7118,7481,5596,5262,5550,4969,4969,4574,3899,3929,2832,0,1940,1682,6672,7044,7044,5130,8214,7414,8389,9468,9508,10704,10206,17469,16207,15332,15470,12776,9942,10133,11183,10135,13099,14400,14094,14268,14094,14410,14552,15122},
{38183,39734,24557,24557,21264,22779,30129,15523,13478,10808,11248,11850,13288,18058,18409,18409,22620,12646,7430,7988,2612,8127,7654,7529,7207,6128,5843,6153,6253,6615,4731,4397,5362,4899,4899,4386,3711,3740,2644,1904,0,470,6457,6856,6856,4942,8025,7226,8201,9280,9320,10515,10018,18754,15900,15026,15163,12469,9635,9826,10876,9828,12778,14079,13773,13947,13773,14089,14270,14815},
{38106,39657,24480,24480,21187,22702,30052,16640,14594,10731,11171,11773,13211,17981,18332,18332,22543,12443,7227,7785,2409,8050,7577,7452,7130,5924,5640,6076,6176,6538,4654,4320,5159,4578,4578,4182,3507,3537,2440,1701,486,0,6380,6653,6653,4738,7822,7022,7997,9077,9116,10312,9814,18550,15823,14948,15086,12392,9558,9749,10799,9751,12707,14008,13702,13876,13702,14018,14193,14738},
{33793,37823,20167,20167,16875,18389,28218,11134,9088,6419,6858,7461,8899,13669,14020,14020,18230,15439,10224,10712,8160,10006,9532,9408,9086,8770,8670,8032,8131,7640,6609,6275,7438,6778,6778,6634,6555,6585,6439,6724,6635,6558,0,9776,9776,8440,11523,10724,11422,12778,12817,14013,13516,23665,17778,16904,17042,14347,11514,11704,12754,11706,14657,15958,15652,15826,15652,15968,16148,16694},
{41626,39592,27999,27999,24707,26222,29987,18966,16920,14251,14690,15293,16731,21501,21852,21852,26063,18101,12885,13443,8078,4239,3674,3442,4432,1580,2795,4134,4339,5589,4130,4338,3177,3202,3202,4121,4344,4374,5833,7359,6556,6922,9900,0,0,2824,5963,3345,3078,6093,5365,6561,5860,9946,11266,10392,10530,8134,5300,5827,6877,5829,7796,9096,8790,8964,8790,9106,9248,10182},
{41626,39592,27999,27999,24707,26222,29987,18966,16920,14251,14690,15293,16731,21501,21852,21852,26063,18101,12885,13443,8078,4239,3674,3442,4432,1580,2795,4134,4339,5589,4130,4338,3177,3202,3202,4121,4344,4374,5833,7359,6556,6922,9900,0,0,2824,5963,3345,3078,6093,5365,6561,5860,9946,11266,10392,10530,8134,5300,5827,6877,5829,7796,9096,8790,8964,8790,9106,9248,10182},
{40196,38868,26570,26570,23277,24792,29263,17536,15490,12821,13260,13863,15301,20071,20422,20422,24633,16463,11248,11805,6441,5473,4908,5024,4510,3084,2873,4192,4397,5379,3865,3531,3234,2899,2899,2563,2785,2815,4196,5722,4918,5284,8470,3122,3122,0,3775,2604,3454,4658,4697,5893,5396,9832,12348,11473,11611,9215,6382,6908,7958,6910,8877,10178,9871,10046,9871,10188,10329,11263},
{43541,42213,29914,29914,26622,28136,32608,20881,18835,16166,16605,17208,18646,23416,23767,23767,27978,23333,18118,18706,9785,8858,8293,8061,7854,6122,6218,7536,7742,8724,7210,6876,6579,6244,6244,5908,6130,6160,7540,9066,8263,8629,11814,6159,6159,3811,0,5358,6208,7413,7452,8648,8150,14037,15652,14778,14916,12117,9284,9811,10860,9812,12181,13482,13176,13350,13176,13492,13634,14568},
{42320,40474,28694,28694,25401,26916,30868,19660,17615,14945,15384,15987,17425,22195,22546,22546,26757,18587,13372,13929,8565,5978,5414,5181,5313,3347,3676,5015,5220,6471,5011,5219,4058,4084,4084,4687,4910,4939,6320,7846,7042,7408,10594,2708,2708,3002,5345,0,1935,4949,4221,5417,4716,9152,11971,11097,11235,8839,6005,6532,7582,6534,8500,9801,9495,9669,9495,9811,9953,10887},
{43201,41168,29575,29575,26282,27797,31562,20541,18496,15826,16266,16868,18306,23076,23427,23427,27638,19676,14460,15018,9654,6046,5482,5249,5586,3372,3949,5751,5914,7165,5705,5913,4752,4778,4778,5696,5919,5949,7408,8934,8131,8497,11475,2732,2732,4010,6353,2237,0,3260,2532,3728,3026,7463,11006,10131,10269,8851,6164,6544,7867,6546,7534,8836,8529,8704,8529,8846,8987,9921},
{51064,44284,37438,37438,34145,36229,34679,27696,25651,23689,24129,24731,26170,30940,31290,31290,32586,23468,18253,18841,11115,9163,8598,8366,8703,6488,7066,8868,9031,10282,8822,8206,7869,7894,7894,7237,7460,7490,8870,10396,9592,9959,13144,5849,5849,5552,7895,3890,3117,0,1111,1932,3489,9261,14122,13248,13386,11968,9280,9661,10984,9663,10651,11952,11646,11820,11646,11962,12104,13038},
{44669,43486,31043,31043,27750,35815,33880,27282,25237,17294,17734,18336,19774,24544,24895,24895,32172,23054,17839,18427,10914,8364,7800,7567,7904,5690,6267,8069,8232,9483,8023,8004,7070,7096,7096,7036,7259,7288,8669,10195,9391,9758,12943,5050,5050,5351,7694,3439,2318,1050,0,1518,2367,5824,13323,12449,12587,11169,8482,8862,10185,8864,9852,11154,10847,11022,10847,11164,11305,12239},
{50402,44258,36776,36776,33483,35567,34652,27034,24988,23027,23467,24069,25507,30277,30628,30628,31923,22806,17590,18179,11686,9136,8572,8339,8676,6462,7039,8841,9005,10255,8795,8777,7842,7868,7868,7808,8031,8061,9441,10967,10163,10530,13715,5822,5822,6123,8466,4212,3090,1627,869,0,2605,8599,14096,13222,13359,11941,9254,9635,10957,9636,10625,11926,11620,11794,11620,11936,12078,13011},
{44955,43688,31329,31329,28036,29551,34082,22295,20250,17580,18020,18622,20060,24830,25181,25181,29392,25674,20458,21047,11200,8075,7511,7278,7756,5989,6566,8141,8532,9782,8322,8290,7370,7395,7395,7322,7544,7574,8955,10481,9677,10043,13229,5350,5350,5637,7980,3971,2836,3670,2864,3661,0,5357,12261,11387,11524,10601,7419,8044,9122,8105,8790,10091,9785,9959,9785,10101,10243,11177},
{50063,53384,36437,36437,33144,35228,43779,26695,24649,22688,23127,23730,25168,29938,30289,30289,31584,22467,17251,17840,16264,12205,11640,11270,11885,10077,10654,12271,12478,13814,12433,12642,11481,11506,11506,11693,11916,11945,18711,17008,18087,18454,24502,9438,9438,10008,13118,8158,7036,6765,5882,6075,4334,0,14942,14068,14206,13408,10107,10810,11803,10871,11471,12772,12466,12640,12466,12782,12924,13858},
{52152,42467,35516,35516,39416,28352,32862,19819,24437,21767,22207,22809,24247,29017,29368,29368,33579,26298,21082,21640,16275,7883,7885,7855,8644,9505,9724,9829,9712,10489,11199,11408,10653,10678,10678,11597,11820,11849,13658,15556,14752,15119,17416,9502,9502,11833,14972,11772,10370,13385,12657,13853,12238,14851,0,452,445,3976,7013,5992,4918,5924,4045,3344,3180,3200,3180,2896,2486,2323},
{52107,42422,35663,35663,39371,28307,32816,19774,24584,21914,22354,22956,24395,29165,29515,29515,33726,26445,21230,21787,16422,8031,8032,8002,8791,9652,9871,9976,9859,10637,11346,11555,10800,10825,10825,11744,11967,11997,13805,15704,14900,15266,17563,9650,9650,11980,15119,11919,10518,13532,12804,14000,12385,14998,844,0,617,4123,7160,6140,5065,6072,4192,3491,3328,3347,3328,3043,2633,2758},
{51827,42142,35191,35191,39091,28027,32537,19494,24112,21442,21882,22484,23922,28692,29043,29043,33254,25973,20757,21315,15950,7558,7560,7530,8319,9180,9399,9504,9387,10164,10874,11082,10328,10353,10353,11272,11495,11524,13332,15231,14428,14794,17091,9178,9178,11508,14646,11447,10045,13060,12332,13528,11913,14526,730,1738,0,3651,6688,5668,4593,5599,3720,3019,2856,2875,2856,2571,2161,2559},
{49289,39605,32647,32647,36554,25490,29999,16957,21568,18899,19338,19940,21379,26149,26500,26500,30710,23429,18214,18771,13407,5015,5016,4986,5775,6636,6855,6960,6843,7621,8330,8539,7784,7809,7809,8728,8951,8981,10789,12688,11884,12250,14547,6859,6859,9262,12324,10204,9244,12258,11530,12726,10997,13610,4205,3331,3468,0,3943,3124,2049,3056,4502,3433,3244,3289,3244,2985,2575,3121},
{47580,37895,29989,29989,26696,23598,28289,15065,18910,16240,16680,17282,18721,23491,23841,23841,28052,20771,15556,16113,10748,3000,2358,2328,3117,3978,4197,4302,4185,5334,5672,5881,5126,5151,5151,6070,6293,6323,8131,10030,9226,9592,11889,4201,4201,6604,9666,7334,5932,8947,8219,9415,7782,10394,7142,6268,6406,3712,0,1405,2455,1407,4012,5313,5007,5181,5007,5323,5513,6058},
{47853,38168,30262,30262,26970,23871,28562,15338,19183,16514,16953,17556,18994,23764,24114,24114,28326,21044,15829,16386,11022,3273,2631,2601,3390,4251,4470,4575,4458,5607,5946,6154,5399,5424,5424,6343,6566,6596,8404,10303,9499,9865,12162,4474,4474,6877,9939,7819,6859,9873,9145,10341,8589,11202,6339,5464,5602,3183,1377,0,1573,671,3304,4605,4299,4473,4299,4615,4709,5254},
{48483,38798,30893,30893,27600,24502,29193,15968,19814,17144,17584,18186,19624,24394,24745,24745,28956,21675,16459,17017,11652,3904,3262,3232,4021,4882,5100,5206,5089,6238,6576,6784,6030,6055,6055,6974,7196,7226,9034,10933,10129,10496,12793,5105,5105,7507,10569,8450,7489,10504,9776,10972,9242,11855,5210,4335,4473,2312,2189,1369,0,1301,2748,4049,3742,3917,3742,4059,3580,4125},
{47182,37497,29592,29592,26299,23200,27892,14667,18512,15843,16282,16885,18323,23093,23444,23444,27655,20374,15158,15716,10351,2603,1961,1931,2720,3581,3799,3905,3788,4936,5275,5483,4728,4754,4754,5673,5895,5925,7733,9632,8828,9195,11492,3804,3804,6206,9268,7148,6188,9203,8475,9671,8552,11164,6717,5843,5980,3286,1192,889,1939,0,3841,5142,4836,5010,4836,5152,5087,5633},
{50150,40465,32559,32559,29267,26168,30860,17635,21480,18811,19250,19853,21291,26061,26412,26412,30623,23341,18126,18684,13319,5570,4929,4898,5688,6285,6767,6872,6756,7904,8243,8451,7696,7722,7722,8640,8863,8893,10701,12600,11796,12162,14459,5965,5965,8295,11434,8234,6833,9847,9120,10315,8700,11313,4423,3549,3687,4356,3476,3036,2444,2968,0,2253,1947,2121,1947,2263,2405,3339},
{51941,42256,34258,34258,30965,28141,32650,19608,23179,20509,20948,21551,22989,27759,28110,28110,32321,25040,19824,20382,15017,7269,6627,6597,7386,7984,8465,8571,8454,9603,9941,10149,9394,9420,9420,10339,10562,10591,12399,14298,13494,13861,16158,7663,7663,9994,13132,9932,8531,11546,10818,12014,10399,13011,3403,2800,2937,3765,5174,4734,4143,4666,2206,0,552,495,552,284,678,1458},
{51618,41934,33878,33878,30585,27819,32328,19286,22798,20129,20568,21171,22609,27379,27730,27730,31941,24660,19444,20002,14637,6889,6247,6217,7006,7604,8085,8191,8074,9222,9561,9769,9014,9040,9040,9959,10181,10211,12019,13918,13114,13481,15778,7283,7283,9613,12752,9552,8151,11166,10438,11634,10018,12631,3410,2536,2674,3443,4794,4354,3763,4286,1826,532,0,328,0,572,714,2137},
{51794,42109,33763,33763,30470,27994,32504,19461,22684,20014,20454,21056,22494,27264,27615,27615,31826,24545,19329,19887,14522,6774,6132,6102,6891,7489,7971,8076,7959,9108,9446,9655,8900,8925,8925,9844,10067,10096,11905,13803,13000,13366,15663,7168,7168,9499,12638,9438,8036,11051,10323,11519,9904,12517,3585,2711,2849,3618,4679,4240,3648,4171,1711,714,204,0,204,755,897,2501},
{51618,41934,33878,33878,30585,27819,32328,19286,22798,20129,20568,21171,22609,27379,27730,27730,31941,24660,19444,20002,14637,6889,6247,6217,7006,7604,8085,8191,8074,9222,9561,9769,9014,9040,9040,9959,10181,10211,12019,13918,13114,13481,15778,7283,7283,9613,12752,9552,8151,11166,10438,11634,10018,12631,3410,2536,2674,3443,4794,4354,3763,4286,1826,532,0,328,0,572,714,2137},
{51727,42042,34428,34428,31135,27927,32437,19394,23349,20679,21118,21721,23159,27929,28280,28280,32491,25210,19994,20552,15187,7439,6797,6767,7556,8154,8635,8741,8624,9773,10111,10319,9564,9590,9590,10509,10732,10761,12569,14468,13664,14031,16328,7833,7833,10164,13302,10102,8701,11716,10988,12184,10569,13181,3190,2586,2724,3551,5344,4904,4313,4836,2376,284,572,665,572,0,503,1244},
{51738,42053,34570,34570,31277,27938,32448,19405,23490,20821,21260,21863,23301,28071,28422,28422,32633,25352,20136,20694,15329,7469,6939,6909,7698,8296,8777,8883,8766,9914,10253,10461,9706,9732,9732,10651,10873,10903,12711,14610,13806,14173,16470,7975,7975,10305,13444,10244,8843,11858,11130,12326,10710,13323,3210,2597,2734,3562,5486,5046,4455,4978,2518,678,714,807,714,503,0,1264},
{51522,41837,34886,34886,38786,27722,32232,19189,23807,21137,21577,22179,23617,28387,28738,28738,32949,25668,20452,21010,15645,7253,7255,7225,8014,8875,9094,9199,9082,9859,10569,10777,10023,10048,10048,10967,11190,11219,13027,14926,14122,14489,16786,8865,8865,11196,14334,11134,9733,12748,12020,13216,11601,14214,2127,2381,2518,3346,6376,5362,4288,5294,3479,1543,2120,2062,2120,1330,1326,0},
};
        }
    }
}